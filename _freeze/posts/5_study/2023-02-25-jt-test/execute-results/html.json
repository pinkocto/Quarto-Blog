{
  "hash": "c6f8c74457d5d76817762595555d62c2",
  "result": {
    "markdown": "---\ntitle: \"JT test\"\nauthor: 'jiyun Lim'\ndate: '02/25/2023'\ncategories: \n  - R\nformat:\n  html:\n    theme: default\n---\n\n\n# JT-test\n\n### Ex1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ ggplot2 3.4.1     ✔ purrr   1.0.1\n✔ tibble  3.2.0     ✔ dplyr   1.1.0\n✔ tidyr   1.3.0     ✔ stringr 1.5.0\n✔ readr   2.1.4     ✔ forcats 1.0.0\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngroup <- c(rep(3,8), rep(2,7), rep(1,7))\nspace <- c(54.0,67.0,47.2,71.1,62.7,44.8,67.4,80.2,\n           79.8,82.0,88.8,79.6,85.7,81.7,88.5,\n          98.6,99.5,95.8,93.3,98.9,91.1,94.5)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# H0: m_N = m_U = m_S\n# H1: m_N >= m_U >= m_s (at least one strict inequality)\nlibrary(clinfun)\njonckheere.test(space, \n                group,\n                alternative = 'decreasing')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tJonckheere-Terpstra test\n\ndata:  \nJT = 2, p-value = 7.29e-09\nalternative hypothesis: decreasing\n```\n:::\n:::\n\n\n### Large-Sample Approximation\n\nFor large sample sizes, J is approximately normally distributed with mean 0 and variance 1. When we use the normal approximation, we compute.\n\n$$\nz = \\frac{J-[(N^2 - \\sum_{i=1}^kn_i^2)/4]}{\\sqrt{[N^2(2N+3)-\\sum_{k=1}^kn_i^2(2n_i+3)]/72}}\n$$\n### Ex2\n\n::: {.cell}\n\n```{.r .cell-code}\njonckheere.test(mtcars$mpg,\n                as.integer(mtcars$cyl),\n                alternative = 'decreasing')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in jonckheere.test(mtcars$mpg, as.integer(mtcars$cyl), alternative = \"decreasing\"): Sample size > 100 or data with ties \n p-value based on normal approximation. Specify nperm for permutation p-value\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tJonckheere-Terpstra test\n\ndata:  \nJT = 5, p-value = 1.153e-08\nalternative hypothesis: decreasing\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nN <- nrow(mtcars)\nn1 <- filter(mtcars, mtcars$cyl == 4) %>% nrow()\nn2 <- filter(mtcars, mtcars$cyl == 6) %>% nrow()\nn3 <- filter(mtcars, mtcars$cyl == 8) %>% nrow()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmu <- ((N^2 - (n1^2+n2^2+n3^2))/4)\nvar_ <- (N^2*(2*N+3)-((n1^2*(2*n1+3) + n2^2*(2*n2+3) + n3^2*(2*n3 + 3))))/72\nmu; var_\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 164.5\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 814.9167\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(5, mu, sqrt(var_), lower.tail = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.152957e-08\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nz_ = (5 - mu) / sqrt(var_)\npnorm(z_,  lower.tail = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.152957e-08\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}