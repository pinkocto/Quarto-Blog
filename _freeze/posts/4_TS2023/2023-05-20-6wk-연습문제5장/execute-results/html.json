{
  "hash": "a0b72f3b03c9953fc944d0d7cbbdb558",
  "result": {
    "markdown": "---\ntitle: 6wk. 연습문제5장 실습\nauthor: JiyunLim\ndate: \"05/20/2023\"\n---\n\n\n## 연습문제 5.3 \n아래와 같이 자료를 입력한다. \n\n::: {.cell}\n\n```{.r .cell-code}\nzt<-c(144.652,195.596,236.569,269.265,296.791,316.682,332.593,344.834,356.644,\n      363.775,370.994,377.784,382.254,386.211,388.574,391.118,394.627,395.785,\n      395.693,396.811,397.249,397.433,398.767,398.971,399.108,400.958,398.660,\n      399.348,398.293,397.886)\n```\n:::\n\n\n### (a) \n시계열 그림을 그려라.\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(zt)\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n### (b) \n(a)의 시계열로부터 $\\rho_1$은 양수, $0$, 혹은 음수 중 어느 값이라 기대되는가?\n\n- $\\rho_1>0$ 일 것으로 기대함. \n\n\n### (c)\n$Z_t$에 대하여 $Z_{t-1}$의 산점도를 그려보고, 다시 $\\rho_1$은 어느 정도의 값이 되리라 기대되는가?\n\n::: {.cell}\n\n```{.r .cell-code}\nyt<-c(zt-mean(zt),0)\nyt_lag1<-c(0,zt-mean(zt))\nplot(yt,yt_lag1)\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlm(yt~yt_lag1)$coefficients[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  yt_lag1 \n0.7867225 \n```\n:::\n:::\n\n- acf의 계수값은 regression을 한 coefficient의 계수값이라고 생각해도 된다.\n\n### (d)\nSACF $\\hat{\\rho}_k,k=0,1,\\dots,10$ 를 구하여 표본상관도표를 그려라.\n\n::: {.cell}\n\n```{.r .cell-code}\nacf_result<-acf(zt)\nacfvalues<-acf_result$acf\nacfvalues\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n, , 1\n\n             [,1]\n [1,]  1.00000000\n [2,]  0.78672246\n [3,]  0.61310906\n [4,]  0.47134840\n [5,]  0.35543318\n [6,]  0.26233059\n [7,]  0.18488731\n [8,]  0.11931704\n [9,]  0.06197039\n[10,]  0.01524803\n[11,] -0.02785225\n[12,] -0.06548592\n[13,] -0.09652258\n[14,] -0.12428019\n[15,] -0.14821524\n```\n:::\n\n```{.r .cell-code}\nplot(acf_result)\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n### (e)\n$Z_t$에 대하여 $Z_{t-2}$의 산점도를 그려보고, 이 그림이 (d)에서 계산된 $\\hat{\\rho}_2$에 상응하는지를 논하라.\n\n::: {.cell}\n\n```{.r .cell-code}\nyt<-c(zt-mean(zt),0,0)\nyt_lag1<-c(0,zt-mean(zt),0)\nyt_lag2<-c(0,0,zt-mean(zt))\nplot(yt,yt_lag2)\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlm(yt~yt_lag2)$coefficients[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  yt_lag2 \n0.6131091 \n```\n:::\n:::\n\n**sacf를 구하는 방법 1**\n\n::: {.cell}\n\n```{.r .cell-code}\ngamma_0 <- sum(yt*yt)\ngamma_1 <- sum(yt*yt_lag1)\nrho1 <- gamma_1/gamma_0\ngamma_2 <- sum(yt*yt_lag2)\nrho2 <- gamma_2/gamma_0\ncat(rho1, rho2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n0.7867225 0.6131091\n```\n:::\n:::\n\n**sacf를 구하는 방법 2**\n\n::: {.cell}\n\n```{.r .cell-code}\nacf(zt)$acf\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n, , 1\n\n             [,1]\n [1,]  1.00000000\n [2,]  0.78672246\n [3,]  0.61310906\n [4,]  0.47134840\n [5,]  0.35543318\n [6,]  0.26233059\n [7,]  0.18488731\n [8,]  0.11931704\n [9,]  0.06197039\n[10,]  0.01524803\n[11,] -0.02785225\n[12,] -0.06548592\n[13,] -0.09652258\n[14,] -0.12428019\n[15,] -0.14821524\n```\n:::\n:::\n\n**sacf를 구하는 방법 3**\n\n::: {.cell}\n\n```{.r .cell-code}\n# (1) rho1을 구하는 법: yt ~ yt_lag1\nlm(yt~yt_lag1)$coef[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  yt_lag1 \n0.7867225 \n```\n:::\n\n```{.r .cell-code}\n# (2) rho2을 구하는 법: yt ~ yt_lag2\nlm(yt~yt_lag2)$coef[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  yt_lag2 \n0.6131091 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(2,1))\nplot(yt_lag1, yt)\nplot(yt_lag2, yt)\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n- 위에 있는 그래프의 기울기가 아래에 있는 그래프의 기울기보다 조금 더 가파르게 나타난다. (아주 미세한 차이지만..)\n- 즉, yt와 lag1의 correlation이 yt와 lag2의 correlation 보다 강하다고 추측을 할 수 있다.\n\n\n### (f)\nSPACF $\\hat{\\phi}_{kk},k=1,2,\\dots,10$을 구하여 표본상관도표를 그려라.\n\n::: {.cell}\n\n```{.r .cell-code}\npacf_result<-pacf(zt)\npacfvalues<-pacf_result$acf\npacfvalues\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n, , 1\n\n             [,1]\n [1,]  0.78672246\n [2,] -0.01528120\n [3,] -0.01665983\n [4,] -0.01737239\n [5,] -0.01327075\n [6,] -0.02047259\n [7,] -0.02399628\n [8,] -0.02955509\n [9,] -0.02187769\n[10,] -0.03562721\n[11,] -0.03251304\n[12,] -0.02901910\n[13,] -0.03540586\n[14,] -0.03479451\n```\n:::\n\n```{.r .cell-code}\nplot(pacf_result)\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n- 파란 점선보다 작으면 $0$으로 봐도 무방하다.\n- PACF는 Lag=1일 때를 제외하고 나머지는 절삭된다. $\\to$  Lag1은 의미있다. $\\to$ AR(1) 모델로 추정.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacf(zt) # exponential 하게 감소\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(zt) # 이것만 보면 non-stationary 같음.\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(zt[15:30]) # 무한대로 가면 stationary 하겠다!\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n### (g)\n$\\hat{\\phi}_{22}$의 의미: \n\n1. 교재의 설명: $\\hat{\\phi}_{22}$는 $Z_t$와 $Z_{t+2}$로부터 $Z_{t+1}$의 효과를 제거한후 2시차만큼 떨어진 $Z_t$와 $Z_{t+2}$의 순수한 상관계수. (p.199)\n\n2. 좀더 엄밀한 정의 \n(1) partial correlation (conditional correlation) \n(2) coefficients in the multiple regression model \n(3) (orthogonalization) partial regression coefficients -- back fitting이라고도 함.\n\n#### (방법1) \nlag=2에선 SPACF, 즉 $\\hat{\\phi}_{22}$는 아래와 같이 구할수 있다. \n\n::: {.cell}\n\n```{.r .cell-code}\npacfvalues[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.0152812\n```\n:::\n:::\n\n#### (방법2) \n\n::: {.cell}\n\n```{.r .cell-code}\nlm1<-lm(yt~yt_lag1+yt_lag2)\nlm1$coefficients[3]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   yt_lag2 \n-0.0152812 \n```\n:::\n:::\n\n#### (방법3) \n- step1: residual을 구한다.\n- step2: residual끼리 regression\n- step3: 적합한 모델의 coef\n\n::: {.cell}\n\n```{.r .cell-code}\nlm01<-lm(yt~yt_lag1)\nlm21<-lm(yt_lag2~yt_lag1)\nres1<-lm01$residuals\nres2<-lm21$residuals\nlm(res1~res2)$coefficients[2] # pacf(zt)$acf[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      res2 \n-0.0152812 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npacf(zt)$acf[2]\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.0152812\n```\n:::\n:::\n\n\n:::{.callout-note}\n- `lm1$coefficient[3]` : $\\phi_{21}$\n- `lm(yt~yt_lag1)$coef[2]` : $\\phi_{11}$\n:::\n\n\n--- \n\n## 연습문제 5.5\n확률과정 $Z_t=1+0.9Z_{t-1}+\\epsilon_t$, $t=1,2,\\dots,100$으로부터 시계열 자료를 생성한 후 다음을 수행하라. 단, $Z_0=10$의 값을 주고 $\\{\\epsilon_t\\}$는 $\\text{WN}$ $N(0,1)$이다.\n\n\nmodel: $Z_t=1+0.9Z_{t-1}+\\epsilon_t$, $t=1,2,\\dots,100$. \n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1306) # 평행세계의 인덱스 (1306번째 평행세계)\nzt<-c() # relization된 값.\nzt[1]<-1+0.9*10+rnorm(1)\n# zt[2]<-1+0.9*[1]+rnorm(1)\n# zt[3]<-1+0.9*z[2]+rnorm(1)\nfor(i in 2:100) zt[i]<-1+0.9*zt[i-1]+rnorm(1)\nzt\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] 10.777675 10.660962 11.129924 10.729653  9.382788  9.291090 10.412269\n  [8]  9.280671  9.278990  9.050157  9.777134  9.382744  8.805521  8.574072\n [15]  9.663666 10.008613 10.057641  9.088979  9.827647 10.221844 12.170445\n [22] 12.868114 13.236760 12.939106 14.064829 14.689415 11.874574 10.117136\n [29] 10.736236 11.427874 10.870493 11.926313 13.313631 12.119023 13.091750\n [36] 11.537623 13.564257 12.867269 12.301226 12.746935 13.450774 14.667385\n [43] 13.411673 15.307674 14.310807 13.122243 13.087510 11.151739 12.500317\n [50] 12.134043 12.216240 13.294609 13.236690 13.206157 13.783242 12.746678\n [57] 12.107156 11.286982 10.709525 10.366019  8.197414  9.075633  8.349393\n [64]  9.305533  7.439775  8.190043  8.546629  8.696135 10.773879 10.591572\n [71] 10.394556 10.902747  9.770263 10.122317 10.469193  9.587717  9.321004\n [78]  8.713534  6.863494  8.102941  7.681025  7.309215  4.915844  5.597363\n [85]  6.577784  7.037914  7.518736  6.669018  4.465009  5.514308  7.445960\n [92]  6.222425  4.740820  5.294629  5.991279  5.196732  6.505054  6.643898\n [99]  7.958164  9.135744\n```\n:::\n:::\n\n### (a) \n\n::: {.cell}\n\n```{.r .cell-code}\nplot(zt)\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n### (b)\n\n::: {.cell}\n\n```{.r .cell-code}\nacf(zt)$acf\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n, , 1\n\n           [,1]\n [1,] 1.0000000\n [2,] 0.9151428\n [3,] 0.8532663\n [4,] 0.7983751\n [5,] 0.7465985\n [6,] 0.6884379\n [7,] 0.6189412\n [8,] 0.5726526\n [9,] 0.5286664\n[10,] 0.5073208\n[11,] 0.4852742\n[12,] 0.4497323\n[13,] 0.4147162\n[14,] 0.3788675\n[15,] 0.3569531\n[16,] 0.3327448\n[17,] 0.3041227\n[18,] 0.2785423\n[19,] 0.2625320\n[20,] 0.2264291\n[21,] 0.1947804\n```\n:::\n:::\n\n### (c)\n\n::: {.cell}\n\n```{.r .cell-code}\npacf(zt)$acf # 정상인 AR(1)\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n, , 1\n\n              [,1]\n [1,]  0.915142832\n [2,]  0.097099164\n [3,]  0.027803130\n [4,]  0.002343684\n [5,] -0.060069904\n [6,] -0.111745287\n [7,]  0.080637070\n [8,]  0.010304596\n [9,]  0.132408979\n[10,]  0.031574334\n[11,] -0.088386730\n[12,] -0.058457746\n[13,] -0.044925052\n[14,]  0.045494186\n[15,]  0.033808509\n[16,] -0.006926641\n[17,]  0.001553929\n[18,]  0.031117106\n[19,] -0.171366229\n[20,] -0.022407217\n```\n:::\n:::\n\n### (d)-(e)\n\n::: {.cell}\n\n```{.r .cell-code}\nyt<-c(zt,mean(zt),mean(zt))\nyt_lag1<-c(mean(zt),zt,mean(zt))\nyt_lag2<-c(mean(zt),mean(zt),zt)\nplot(yt,yt_lag1)\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlm(yt~yt_lag1)$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)     yt_lag1 \n  0.8585824   0.9151428 \n```\n:::\n\n```{.r .cell-code}\nplot(yt,yt_lag2)\n```\n\n::: {.cell-output-display}\n![](2023-05-20-6wk-연습문제5장_files/figure-html/unnamed-chunk-22-2.png){width=672}\n:::\n\n```{.r .cell-code}\nlm(yt~yt_lag2)$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)     yt_lag2 \n  1.4846471   0.8532663 \n```\n:::\n:::\n",
    "supporting": [
      "2023-05-20-6wk-연습문제5장_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}