<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="JiyunLim">
<meta name="dcterms.date" content="2023-06-25">

<title>Quarto-Blog - [Fourier] 푸리에변환 코드실습 (블로그)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Quarto-Blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pinkocto"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><strong>[Fourier]</strong> 푸리에변환 코드실습 (블로그)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block"><strong>[Fourier]</strong> 푸리에변환 코드실습 (블로그)</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>JiyunLim </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 25, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../1_ip2022.html" class="sidebar-item-text sidebar-link">IP2022</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2_dv2022.html" class="sidebar-item-text sidebar-link">DV2022</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../3_stbda2022.html" class="sidebar-item-text sidebar-link">STBDA2022</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../4_ts2023.html" class="sidebar-item-text sidebar-link">TS2023</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../5_study.html" class="sidebar-item-text sidebar-link">STUDY</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../6_note.html" class="sidebar-item-text sidebar-link">NOTE</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#lets-get-started" id="toc-lets-get-started" class="nav-link" data-scroll-target="#lets-get-started">Let’s get started</a></li>
  <li><a href="#fft" id="toc-fft" class="nav-link" data-scroll-target="#fft">FFT</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>ref: <a href="https://towardsdatascience.com/fourier-transform-the-practical-python-implementation-acdd32f1b96a" class="uri">https://towardsdatascience.com/fourier-transform-the-practical-python-implementation-acdd32f1b96a</a></p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Fourier Transform (FT) relates the time domain of a signal to its frequency domain, where the frequency domain contains the information about the sinusoids (amplitude, frequency, phase) that construct the signal. Since FT is a continuous transform, the Discrete Fourier Transform (DFT) becomes the applicable transform in the digital world that holds the information of signals in the discrete format as a set of samples, where the sampling theorem is the strict rule of discretizing and the signal. The DFT of a signal (xn) with N number of samples is given by the following equation [2]:</p>
<p><span class="math inline">\(X_k = \sum_{n=0}^{N-1} x_n \cdot e^{i2\pi kn/N}=\sum_{n=0}^{N-1}\cdot [\cos(2\pi k/N) - i\sin(2\pi kn/N)]\)</span></p>
<ul>
<li><span class="math inline">\(N\)</span> : Number of Samples</li>
<li><span class="math inline">\(n\)</span>: Current Sample</li>
<li><span class="math inline">\(k\)</span>: Current frequency where <span class="math inline">\(k\in [0,N-1]\)</span></li>
<li><span class="math inline">\(xn\)</span>: The sine value at sample <span class="math inline">\(n\)</span></li>
<li><span class="math inline">\(Xk\)</span>: The DFT which includes information on both amplitude and phase</li>
</ul>
<p>The output of the DFT (Xk) is an array of complex numbers that hold the information of frequency components [2]. Applying DFT on signals using the mathematical equation directly demands a heavy computation complexity. Luckily, a Fast Fourier Transform (FFT) was developed [3] to provide a faster implementation of the DFT. The FFT takes advantage of the symmetry nature of the output of the DFT. We will not further discuss how FFT works as it’s like the standard practical application of DFT. But if you want more details, refer to [3].</p>
</section>
<section id="lets-get-started" class="level2">
<h2 class="anchored" data-anchor-id="lets-get-started">Let’s get started</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Import the required packages</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">from</span> scipy.fft <span class="im">import</span> fft, rfft</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">from</span> scipy.fft <span class="im">import</span> fftfreq, rfftfreq</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> plotly.graph_objs <span class="im">as</span> go</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">from</span> plotly.subplots <span class="im">import</span> make_subplots</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The signal we will generate using the previous class contains three sinusoids (1, 10, 20) Hz with amplitudes of (3, 1, 0.5), respectively. The sampling rate will be 200 and the duration of the signal is 2 seconds.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Import the required package</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># Building a class Signal for better use.</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw">class</span> Signal:</span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, amplitude<span class="op">=</span><span class="dv">1</span>, frequency<span class="op">=</span><span class="dv">10</span>, duration<span class="op">=</span><span class="dv">1</span>, sampling_rate<span class="op">=</span><span class="fl">100.0</span>, phase<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb2-7"><a href="#cb2-7"></a>        <span class="va">self</span>.amplitude <span class="op">=</span> amplitude</span>
<span id="cb2-8"><a href="#cb2-8"></a>        <span class="va">self</span>.frequency <span class="op">=</span> frequency</span>
<span id="cb2-9"><a href="#cb2-9"></a>        <span class="va">self</span>.duration <span class="op">=</span> duration</span>
<span id="cb2-10"><a href="#cb2-10"></a>        <span class="va">self</span>.sampling_rate <span class="op">=</span> sampling_rate</span>
<span id="cb2-11"><a href="#cb2-11"></a>        <span class="va">self</span>.phase <span class="op">=</span> phase</span>
<span id="cb2-12"><a href="#cb2-12"></a>        <span class="va">self</span>.time_step <span class="op">=</span> <span class="fl">1.0</span><span class="op">/</span><span class="va">self</span>.sampling_rate</span>
<span id="cb2-13"><a href="#cb2-13"></a>        <span class="va">self</span>.time_axis <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="va">self</span>.duration, <span class="va">self</span>.time_step)</span>
<span id="cb2-14"><a href="#cb2-14"></a>  </span>
<span id="cb2-15"><a href="#cb2-15"></a>  <span class="co"># Generate sine wave</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="kw">def</span> sine(<span class="va">self</span>):</span>
<span id="cb2-17"><a href="#cb2-17"></a>        <span class="cf">return</span> <span class="va">self</span>.amplitude<span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span><span class="va">self</span>.frequency<span class="op">*</span><span class="va">self</span>.time_axis<span class="op">+</span><span class="va">self</span>.phase)</span>
<span id="cb2-18"><a href="#cb2-18"></a>  </span>
<span id="cb2-19"><a href="#cb2-19"></a>  <span class="co"># Generate cosine wave</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>    <span class="kw">def</span> cosine(<span class="va">self</span>):</span>
<span id="cb2-21"><a href="#cb2-21"></a>        <span class="cf">return</span> <span class="va">self</span>.amplitude<span class="op">*</span>np.cos(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span><span class="va">self</span>.frequency<span class="op">*</span><span class="va">self</span>.time_axis<span class="op">+</span><span class="va">self</span>.phase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Generate the three signals using Signal class and its method sine()</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>signal_1hz <span class="op">=</span> Signal(amplitude<span class="op">=</span><span class="dv">3</span>, frequency<span class="op">=</span><span class="dv">1</span>, sampling_rate<span class="op">=</span><span class="dv">200</span>, duration<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>sine_1hz <span class="op">=</span> signal_1hz.sine()</span>
<span id="cb3-4"><a href="#cb3-4"></a>signal_20hz <span class="op">=</span> Signal(amplitude<span class="op">=</span><span class="dv">1</span>, frequency<span class="op">=</span><span class="dv">20</span>, sampling_rate<span class="op">=</span><span class="dv">200</span>, duration<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>sine_20hz <span class="op">=</span> signal_20hz.sine()</span>
<span id="cb3-6"><a href="#cb3-6"></a>signal_10hz <span class="op">=</span> Signal(amplitude<span class="op">=</span><span class="fl">0.5</span>, frequency<span class="op">=</span><span class="dv">10</span>, sampling_rate<span class="op">=</span><span class="dv">200</span>, duration<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a>sine_10hz <span class="op">=</span> signal_10hz.sine()</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"># Sum the three signals to output the signal we want to analyze</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>signal <span class="op">=</span> sine_1hz <span class="op">+</span> sine_20hz <span class="op">+</span> sine_10hz</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co"># Plot the signal</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>plt.plot(signal_1hz.time_axis, signal, <span class="st">'b'</span>)</span>
<span id="cb3-14"><a href="#cb3-14"></a>plt.xlabel(<span class="st">'Time [sec]'</span>)</span>
<span id="cb3-15"><a href="#cb3-15"></a>plt.ylabel(<span class="st">'Amplitude'</span>)</span>
<span id="cb3-16"><a href="#cb3-16"></a>plt.title(<span class="st">'Sum of three signals'</span>)</span>
<span id="cb3-17"><a href="#cb3-17"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-06-25-fft-python_files/figure-html/cell-4-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The Fourier Transform of this signal can be calculated using (fft) from the scipy package as follows [4]:</p>
</section>
<section id="fft" class="level2">
<h2 class="anchored" data-anchor-id="fft">FFT</h2>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Apply the FFT on the signal</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>fourier <span class="op">=</span> fft(signal)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># Plot the result (the spectrum |Xk|)</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>plt.plot(np.<span class="bu">abs</span>(fourier))</span>
<span id="cb4-6"><a href="#cb4-6"></a>plt.title(<span class="st">'The output of the FFT of the signal'</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-06-25-fft-python_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The figure above should represent the frequency spectrum of the signal. Notice that the x-axis is the number of samples (instead of the frequency components) and the y-axis should represent the amplitudes of the sinusoids. To get the actual amplitudes of the spectrum, we have to normalize the output of (fft) by N/2 the number of samples.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Calculate N/2 to normalize the FFT output</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>N <span class="op">=</span> <span class="bu">len</span>(signal)</span>
<span id="cb5-3"><a href="#cb5-3"></a>normalize <span class="op">=</span> N<span class="op">/</span><span class="dv">2</span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Plot the normalized FFT (|Xk|)/(N/2)</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>plt.plot(np.<span class="bu">abs</span>(fourier)<span class="op">/</span>normalize)</span>
<span id="cb5-7"><a href="#cb5-7"></a>plt.ylabel(<span class="st">'Amplitude'</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a>plt.xlabel(<span class="st">'Samples'</span>)</span>
<span id="cb5-9"><a href="#cb5-9"></a>plt.title(<span class="st">'Normalized FFT Spectrum'</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-06-25-fft-python_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>To get the frequency components (x-axis), you can use (fftfreq) from the scipy package. This method needs the number of samples (N) and the sampling rate as input arguments. And it returns a frequency axis with N frequency components [5].</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Get the frequency components of the spectrum</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>sampling_rate <span class="op">=</span> <span class="fl">200.0</span> <span class="co"># It's used as a sample spacing</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>frequency_axis <span class="op">=</span> fftfreq(N, d<span class="op">=</span><span class="fl">1.0</span><span class="op">/</span>sampling_rate)</span>
<span id="cb6-4"><a href="#cb6-4"></a>norm_amplitude <span class="op">=</span> np.<span class="bu">abs</span>(fourier)<span class="op">/</span>normalize</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># Plot the results</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>plt.plot(frequency_axis, norm_amplitude)</span>
<span id="cb6-7"><a href="#cb6-7"></a>plt.xlabel(<span class="st">'Frequency[Hz]'</span>)</span>
<span id="cb6-8"><a href="#cb6-8"></a>plt.ylabel(<span class="st">'Amplitude'</span>)</span>
<span id="cb6-9"><a href="#cb6-9"></a>plt.title(<span class="st">'Spectrum'</span>)</span>
<span id="cb6-10"><a href="#cb6-10"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-06-25-fft-python_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The spectrum with the actual amplitudes and frequency axis</p>
<p>To understand what happened in the last code, let’s plot only the frequency axis:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Plot the frequency axis for more explanation</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>plt.plot(frequency_axis)</span>
<span id="cb7-3"><a href="#cb7-3"></a>plt.ylabel(<span class="st">'Frequency[Hz]'</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>plt.title(<span class="st">'Frequency Axis'</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-06-25-fft-python_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Notice that the frequency array starts at zero. Then, it begins to increase with (d) step by step to reach its maximum (100Hz). After that, it starts from the negative maximum frequency (-100Hz) to increase back again with (d) step by step. The maximum frequency that can hold information from the signal (100Hz) is half of the sampling rate and this is true according to the Sampling Theorem [2].</p>
<p>Due to the symmetry of the spectrum for the real-value signals, we only focus on the first half of the spectrum [2]. The <code>Scipy package</code> provides methods to deal with the Fourier transform of the real-value signals, where it takes advantage symmetry nature of the spectrum. Such methods are (rfft [6], rfftfreq [7]). These methods are the same as (fft, fftfreq), respectively. By comparing the time execution between (fft) and (rfft) methods on the same signal, you’ll find that (rfft) is a little bit faster. When dealing with real-value signals, which is most likely the case, using (rfft) is the best choice.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Calculate the time execution of (fft)</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="bu">print</span>(<span class="st">'Execution time of fft function:'</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="op">%</span>timeit fft(signal)</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># Calculate the time execution of (rfft)</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">Execution time of rfft function:'</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="op">%</span>timeit rfft(signal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Execution time of fft function:
4.08 µs ± 11.2 ns per loop (mean ± std. dev. of 7 runs, 100,000 loops each)

Execution time of rfft function:
4 µs ± 5.39 ns per loop (mean ± std. dev. of 7 runs, 100,000 loops each)</code></pre>
</div>
</div>
<p>To conclude our discussion about scaling the amplitudes and generating the frequency axis of the spectrum for real-values signal data that have a symmetry nature in their frequency domain, the code below represents the final form of the spectrum (the actual amplitudes on the right frequencies).</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Plot the actual spectrum of the signal</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>plt.plot(rfftfreq(N, d<span class="op">=</span><span class="dv">1</span><span class="op">/</span>sampling_rate), <span class="dv">2</span><span class="op">*</span>np.<span class="bu">abs</span>(rfft(signal))<span class="op">/</span>N)</span>
<span id="cb10-3"><a href="#cb10-3"></a>plt.title(<span class="st">'Spectrum'</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a>plt.xlabel(<span class="st">'Frequency[Hz]'</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a>plt.ylabel(<span class="st">'Amplitude'</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-06-25-fft-python_files/figure-html/cell-10-output-1.png" class="img-fluid"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>